$(function(){var o=$("#map"),a=$("#svg"),c=$("#inner"),n=a[0].viewBox.baseVal,r=n.width,s=n.height,u=1,l={x:0,y:0},h=!1,m={x:0,y:0},x=new Map,y=null,f=null;function d(n,t,e){return Math.max(t,Math.min(e,n))}function g(){return Math.max(o.width()/r,o.height()/s)}function v(n,t){t=1<arguments.length&&void 0!==t?t:"mouse";n&&"touch"!==t?"mouse-drag"===t?c.css("transition","transform 0.03s ease-out"):c.css("transition","transform 0.38s ease-out"):c.css("transition","none")}function p(){var n=o.width(),t=o.height(),e=r*u,i=s*u,n=Math.min(0,n-e),e=Math.min(0,t-i);l.x=d(l.x,n,0),l.y=d(l.y,e,0),c.css("transform","translate(".concat(l.x,"px, ").concat(l.y,"px) scale(").concat(u,")"))}function t(){var n=o.width(),t=o.height(),e=(u=Math.max(n/r,t/s),r*u),i=s*u;l.x=(n-e)/2,l.y=(t-i)/2,p()}function M(n,t){var e=t.clientX-n.clientX;return Math.hypot(e,t.clientY-n.clientY)}function w(n,t){return{x:(n.clientX+t.clientX)/2,y:(n.clientY+t.clientY)/2}}a.on("pointerdown",function(n){a.css("touch-action","none"),x.set(n.pointerId,n),1===x.size?(m={x:n.clientX-l.x,y:n.clientY-l.y},h=!0,a.css("cursor","grabbing")):2===x.size&&(n=Array.from(x.values()),y=M(n[0],n[1]),f=w(n[0],n[1]),v(!1,"touch"))}),a.on("pointermove",function(n){var t,e,i,o;x.has(n.pointerId)&&(x.set(n.pointerId,n),1===x.size&&h?(t=Array.from(x.values())[0],l={x:t.clientX-m.x,y:t.clientY-m.y},v(!0,"mouse"===n.pointerType?"mouse":"touch"),p()):2===x.size&&(n=M((t=Array.from(x.values()))[0],t[1]),t=w(t[0],t[1]),y&&f&&(e=u,u*=n/y,u=Math.max(u,g()),u=Math.min(u,5),i=t.x-l.x,o=t.y-l.y,l.x-=i*(u/e-1),l.y-=o*(u/e-1),v(!1,"touch"),p()),y=n,f=t))}),a.on("pointerup pointercancel",function(n){x.delete(n.pointerId),2===x.size?(n=Array.from(x.values()),y=M(n[0],n[1]),f=w(n[0],n[1])):1===x.size?(n=Array.from(x.values())[0],m={x:n.clientX-l.x,y:n.clientY-l.y},h=!(f=y=null)):(h=!1,f=y=null,a.css("cursor","grab"))}),a.on("wheel",function(n){n.preventDefault(),v(!0,"mouse");var t=u,e=(u+=5e-4*-n.originalEvent.deltaY,u=Math.max(u,g()),u=Math.min(u,5),a[0].getBoundingClientRect()),i=n.clientX-e.left-l.x,n=n.clientY-e.top-l.y;l.x-=i*(u/t-1),l.y-=n*(u/t-1),p()}),$("#zoom-in").on("click",function(){var n=u,t=(u*=1.2,u=Math.max(u,g()),u=Math.min(u,5),o[0].getBoundingClientRect()),e=t.width/2,t=t.height/2,i=(e-l.x)/n,n=(t-l.y)/n;l.x=e-i*u,l.y=t-n*u,v(!0,"mouse"),p()}),$("#zoom-out").on("click",function(){var n=u,t=(u/=1.2,u=Math.max(u,g()),u=Math.min(u,5),o[0].getBoundingClientRect()),e=t.width/2,t=t.height/2,i=(e-l.x)/n,n=(t-l.y)/n;l.x=e-i*u,l.y=t-n*u,v(!0,"mouse"),p()}),$("#reset").on("click",function(){t()}),$(window).on("resize",t),t()});