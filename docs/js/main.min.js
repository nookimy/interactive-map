$(function(){var o=$("#map"),c=$("#svg"),a=$("#inner"),n=c[0].viewBox.baseVal,r=n.width,h=n.height,s=1,u={x:0,y:0},l=!1,x={x:0,y:0},m=new Map,y=null,f=null;function d(n,t,i){return Math.max(t,Math.min(i,n))}function g(){return Math.max(o.width()/r,o.height()/h)}function p(n,t){n&&"touch"!==(1<arguments.length&&void 0!==t?t:"mouse")?a.css("transition","transform 0.2s ease-out"):a.css("transition","none")}function v(){var n=o.width(),t=o.height(),i=r*s,e=h*s,n=Math.min(0,n-i),i=Math.min(0,t-e);u.x=d(u.x,n,0),u.y=d(u.y,i,0),a.css("transform","translate(".concat(u.x,"px, ").concat(u.y,"px) scale(").concat(s,")"))}function t(){var n=o.width(),t=o.height(),i=(s=Math.max(n/r,t/h),r*s),e=h*s;u.x=(n-i)/2,u.y=(t-e)/2,v()}function M(n,t){var i=t.clientX-n.clientX;return Math.hypot(i,t.clientY-n.clientY)}function w(n,t){return{x:(n.clientX+t.clientX)/2,y:(n.clientY+t.clientY)/2}}c.on("pointerdown",function(n){c.css("touch-action","none"),m.set(n.pointerId,n),1===m.size?(l=!0,x={x:n.clientX-u.x,y:n.clientY-u.y},c.css("cursor","grabbing")):2===m.size&&(n=Array.from(m.values()),y=M(n[0],n[1]),f=w(n[0],n[1]))}),c.on("pointermove",function(n){var t,i,e,o;m.has(n.pointerId)&&(m.set(n.pointerId,n),1===m.size&&l?(p(!(u={x:n.clientX-x.x,y:n.clientY-x.y}),"touch"),v()):2===m.size&&(t=M((n=Array.from(m.values()))[0],n[1]),n=w(n[0],n[1]),y&&f&&(i=s,s*=t/y,s=Math.max(s,g()),s=Math.min(s,5),e=n.x-u.x,o=n.y-u.y,u.x-=e*(s/i-1),u.y-=o*(s/i-1),p(!1,"touch"),v()),y=t,f=n))}),c.on("pointerup pointercancel",function(n){m.delete(n.pointerId),m.size<2&&(f=y=null),0===m.size&&(l=!1,c.css("cursor","grab"))}),c.on("wheel",function(n){n.preventDefault(),p(!0,"mouse");var t=s,i=(s+=5e-4*-n.originalEvent.deltaY,s=Math.max(s,g()),s=Math.min(s,5),c[0].getBoundingClientRect()),e=n.clientX-i.left-u.x,n=n.clientY-i.top-u.y;u.x-=e*(s/t-1),u.y-=n*(s/t-1),v()}),$("#zoom-in").on("click",function(){var n=s,t=(s*=1.2,s=Math.max(s,g()),s=Math.min(s,5),o[0].getBoundingClientRect()),i=t.width/2,t=t.height/2,e=(i-u.x)/n,n=(t-u.y)/n;u.x=i-e*s,u.y=t-n*s,p(!0,"mouse"),v()}),$("#zoom-out").on("click",function(){var n=s,t=(s/=1.2,s=Math.max(s,g()),s=Math.min(s,5),o[0].getBoundingClientRect()),i=t.width/2,t=t.height/2,e=(i-u.x)/n,n=(t-u.y)/n;u.x=i-e*s,u.y=t-n*s,p(!0,"mouse"),v()}),$("#reset").on("click",function(){t()}),$(window).on("resize",t),t()});