$(function(){var o=$("#map"),c=$("#svg"),a=$("#inner"),n=c[0].viewBox.baseVal,u=n.width,l=n.height,h=1,r={x:0,y:0},s=!1,x={x:0,y:0},g=null,m=null;function y(n,t,e){return Math.max(t,Math.min(e,n))}function f(){return Math.max(o.width()/u,o.height()/l)}function v(n,t){n?"touch"===(1<arguments.length&&void 0!==t?t:"mouse")?a.css("transition","transform 0.05s linear"):a.css("transition","transform 0.2s ease-out"):a.css("transition","none")}function d(){var n=o.width(),t=o.height(),e=u*h,i=l*h,n=Math.min(0,n-e),e=Math.min(0,t-i);r.x=y(r.x,n,0),r.y=y(r.y,e,0),a.css("transform","translate(".concat(r.x,"px, ").concat(r.y,"px) scale(").concat(h,")"))}function t(){var n=o.width(),t=o.height(),e=(h=Math.max(n/u,t/l),u*h),i=l*h;r.x=(n-e)/2,r.y=(t-i)/2,d()}function w(n,t){var e=t.clientX-n.clientX;return Math.hypot(e,t.clientY-n.clientY)}function M(n,t){return{x:(n.clientX+t.clientX)/2,y:(n.clientY+t.clientY)/2}}c.on("mousedown",function(n){v(!(s=!0)),x={x:n.clientX-r.x,y:n.clientY-r.y},c.css("cursor","grabbing")}),$(window).on("mousemove",function(n){s&&(r={x:n.clientX-x.x,y:n.clientY-x.y},d())}),$(window).on("mouseup",function(){s=!1,c.css("cursor","grab")}),c.on("wheel",function(n){n.preventDefault(),v(!0,"mouse");var t=h,e=(h+=5e-4*-n.originalEvent.deltaY,h=Math.max(h,f()),c[0].getBoundingClientRect()),i=n.clientX-e.left-r.x,n=n.clientY-e.top-r.y;r.x-=i*(h/t-1),r.y-=n*(h/t-1),d()}),c.on("touchstart",function(n){v(!0,"touch");var t,n=n.originalEvent.touches;1===n.length?(s=!0,t=n[0],x={x:t.clientX-r.x,y:t.clientY-r.y}):2===n.length&&(g=w(n[0],n[1]),m=M(n[0],n[1]))}),c.on("touchmove",function(n){n.preventDefault(),v(!0,"touch");var t,e,i,o,n=n.originalEvent.touches;1===n.length&&s?(t=n[0],r={x:t.clientX-x.x,y:t.clientY-x.y},d()):2===n.length&&(t=w(n[0],n[1]),n=M(n[0],n[1]),g&&m&&(e=h,h*=t/g,h=Math.max(h,f()),i=n.x-r.x,o=n.y-r.y,r.x-=i*(h/e-1),r.y-=o*(h/e-1),d()),g=t,m=n)}),c.on("touchend",function(n){n=n.originalEvent.touches;n.length<2&&(m=g=null),0===n.length&&(s=!1)}),$("#zoom-in").on("click",function(){var n=h,t=(h*=1.2,h=Math.max(h,f()),o[0].getBoundingClientRect()),e=t.width/2,t=t.height/2,i=(e-r.x)/n,n=(t-r.y)/n;r.x=e-i*h,r.y=t-n*h,v(!0,"mouse"),d()}),$("#zoom-out").on("click",function(){var n=h,t=(h/=1.2,h=Math.max(h,f()),o[0].getBoundingClientRect()),e=t.width/2,t=t.height/2,i=(e-r.x)/n,n=(t-r.y)/n;r.x=e-i*h,r.y=t-n*h,v(!0,"mouse"),d()}),$("#reset").on("click",function(){t(),v(!0,"mouse")}),$(window).on("resize",t),t()});