$(function(){var o=$("#map"),a=$("#svg"),c=$("#inner"),n=a[0].viewBox.baseVal,r=n.width,u=n.height,l=1,s={x:0,y:0},h=!1,x={x:0,y:0},m=new Map,y=null,f=null;function v(n,t,e){return Math.max(t,Math.min(e,n))}function d(){return Math.max(o.width()/r,o.height()/u)}function g(n,t){n&&"touch"!==(1<arguments.length&&void 0!==t?t:"mouse")?c.css("transition","transform 0.09s ease-out"):c.css("transition","none")}function p(){var n=o.width(),t=o.height(),e=r*l,i=u*l,n=Math.min(0,n-e),e=Math.min(0,t-i);s.x=v(s.x,n,0),s.y=v(s.y,e,0),c.css("transform","translate(".concat(s.x,"px, ").concat(s.y,"px) scale(").concat(l,")"))}function t(){var n=o.width(),t=o.height(),e=(l=Math.max(n/r,t/u),r*l),i=u*l;s.x=(n-e)/2,s.y=(t-i)/2,p()}function M(n,t){var e=t.clientX-n.clientX;return Math.hypot(e,t.clientY-n.clientY)}function w(n,t){return{x:(n.clientX+t.clientX)/2,y:(n.clientY+t.clientY)/2}}a.on("pointerdown",function(n){a.css("touch-action","none"),m.set(n.pointerId,n),1===m.size?(x={x:n.clientX-s.x,y:n.clientY-s.y},h=!0,a.css("cursor","grabbing")):2===m.size&&(n=Array.from(m.values()),y=M(n[0],n[1]),f=w(n[0],n[1]),g(!1,"touch"))}),a.on("pointermove",function(n){var t,e,i,o;m.has(n.pointerId)&&(m.set(n.pointerId,n),1===m.size&&h?(t=Array.from(m.values())[0],s={x:t.clientX-x.x,y:t.clientY-x.y},g(!0,"mouse"===n.pointerType?"mouse":"touch"),p()):2===m.size&&(n=M((t=Array.from(m.values()))[0],t[1]),t=w(t[0],t[1]),y&&f&&(e=l,l*=n/y,l=Math.max(l,d()),l=Math.min(l,5),i=t.x-s.x,o=t.y-s.y,s.x-=i*(l/e-1),s.y-=o*(l/e-1),g(!1,"touch"),p()),y=n,f=t))}),a.on("pointerup pointercancel",function(n){m.delete(n.pointerId),2===m.size?(n=Array.from(m.values()),y=M(n[0],n[1]),f=w(n[0],n[1])):1===m.size?(n=Array.from(m.values())[0],x={x:n.clientX-s.x,y:n.clientY-s.y},h=!(f=y=null)):(h=!1,f=y=null,a.css("cursor","grab"))}),a.on("wheel",function(n){n.preventDefault(),g(!0,"mouse");var t=l,e=(l+=5e-4*-n.originalEvent.deltaY,l=Math.max(l,d()),l=Math.min(l,5),a[0].getBoundingClientRect()),i=n.clientX-e.left-s.x,n=n.clientY-e.top-s.y;s.x-=i*(l/t-1),s.y-=n*(l/t-1),p()}),$("#zoom-in").on("click",function(){var n=l,t=(l*=1.2,l=Math.max(l,d()),l=Math.min(l,5),o[0].getBoundingClientRect()),e=t.width/2,t=t.height/2,i=(e-s.x)/n,n=(t-s.y)/n;s.x=e-i*l,s.y=t-n*l,g(!0,"mouse"),p()}),$("#zoom-out").on("click",function(){var n=l,t=(l/=1.2,l=Math.max(l,d()),l=Math.min(l,5),o[0].getBoundingClientRect()),e=t.width/2,t=t.height/2,i=(e-s.x)/n,n=(t-s.y)/n;s.x=e-i*l,s.y=t-n*l,g(!0,"mouse"),p()}),$("#reset").on("click",function(){t()}),$(window).on("resize",t),t()});